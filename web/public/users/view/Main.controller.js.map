{"version":3,"sources":["Main.controller.es6.js"],"names":["API_BASE_PATH","extend","onInit","initializeModels","initializeStyleClass","onRefresh","window","document","title","getView","getModel","getProperty","oModel","bundleUrl","setModel","users","current","newUsername","sClass","support","touch","addStyleClass","byId","ajax","url","method","dataType","success","setProperty","oData","removeSelections","error","onError","bind","oXhr","sStatus","sError","i18n","details","onSelect","oEvent","oItem","getParameter","oUser","getBindingContext","getObject","onToggleActivation","data","username","active","onResetPassword","onOpenCreateDialog","open","onCloseCreateDialog","close","onRegisterUser","onNavBack","history","go"],"mappings":"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","file":"Main.controller.js","sourcesContent":["import Controller from \"sap/ui/core/mvc/Controller\";\r\nimport Device from \"sap/ui/Device\";\r\nimport ResourceModel from \"sap/ui/model/resource/ResourceModel\";\r\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\r\nimport MessageBox from \"sap/m/MessageBox\";\r\nimport jQuery from \"jquery.sap.global\";\r\n\r\nconst API_BASE_PATH = \"/public/rest/user/manage\";\r\n\r\n/**\r\n * Login controller class.\r\n * @class\r\n */\r\nexport default Controller.extend(\"spet.sbwo.web.public.users.view.Main\", {\r\n    onInit() {\r\n        this.initializeModels();\r\n        this.initializeStyleClass();\r\n        this.onRefresh();\r\n        window.document.title = this.getView().getModel(\"i18n\").getProperty(\"pageTitle\");\r\n    },\r\n\r\n    initializeModels() {\r\n        let oModel = new ResourceModel({\r\n            bundleUrl: \"i18n/i18n.properties\"\r\n        });\r\n        this.getView().setModel(oModel, \"i18n\");\r\n        this.getView().setModel(new JSONModel({\r\n            users: [],\r\n            current: null,\r\n            newUsername: \"\"\r\n        }), \"view\");\r\n    },\r\n\r\n    initializeStyleClass() {\r\n        const sClass = Device.support.touch ? \"sapUiSizeCozy\" : \"sapUiSizeCompact\";\r\n        this.getView().addStyleClass(sClass);\r\n        this.byId(\"dlgCreate\").addStyleClass(sClass);\r\n    },\r\n\r\n    onRefresh() {\r\n        let oModel = this.getView().getModel(\"view\");\r\n        jQuery.ajax({\r\n            url: API_BASE_PATH + \"/list\",\r\n            method: \"GET\",\r\n            dataType: \"json\",\r\n            success: oData => {\r\n                oModel.setProperty(\"/users\", oData);\r\n                oModel.setProperty(\"/current\", null);\r\n                this.byId(\"lstUsers\").removeSelections(true);\r\n            },\r\n            error: this.onError.bind(this)\r\n        });\r\n    },\r\n\r\n    onError(oXhr, sStatus, sError) {\r\n        const i18n = this.getView().getModel(\"i18n\");\r\n        MessageBox.error(i18n.getProperty(\"txtErrorMessageText\"), {\r\n            details: sError\r\n        });\r\n    },\r\n\r\n    onSelect(oEvent) {\r\n        let oModel = this.getView().getModel(\"view\"),\r\n            oItem = oEvent.getParameter(\"listItem\");\r\n        if (oEvent.getParameter(\"selected\") && oItem) {\r\n            let oUser = oItem.getBindingContext(\"view\").getObject();\r\n            oModel.setProperty(\"/current\", oUser);\r\n        } else {\r\n            oModel.setProperty(\"/current\", null);\r\n        }\r\n    },\r\n\r\n    onToggleActivation() {\r\n        let oModel = this.getView().getModel(\"view\");\r\n        jQuery.ajax({\r\n            url: API_BASE_PATH + \"/activate\",\r\n            method: \"POST\",\r\n            data: {\r\n                username: oModel.getProperty(\"/current/username\"),\r\n                active: !oModel.getProperty(\"/current/active\")\r\n            },\r\n            success: this.onRefresh.bind(this),\r\n            error: this.onError.bind(this)\r\n        });\r\n    },\r\n\r\n    onResetPassword() {\r\n        let oModel = this.getView().getModel(\"view\"),\r\n            i18n = this.getView().getModel(\"i18n\");\r\n        jQuery.ajax({\r\n            url: API_BASE_PATH + \"/reset\",\r\n            method: \"POST\",\r\n            data: {\r\n                username: oModel.getProperty(\"/current/username\")\r\n            },\r\n            success: () => MessageBox.success(i18n.getProperty(\"txtPasswordResetText\")),\r\n            error: this.onError.bind(this)\r\n        });\r\n    },\r\n\r\n    onOpenCreateDialog() {\r\n        this.getView().getModel(\"view\").setProperty(\"/newUsername\", \"\");\r\n        this.byId(\"dlgCreate\").open();\r\n    },\r\n\r\n    onCloseCreateDialog() {\r\n        this.byId(\"dlgCreate\").close();\r\n    },\r\n\r\n    onRegisterUser() {\r\n        let oModel = this.getView().getModel(\"view\");\r\n        jQuery.ajax({\r\n            url: API_BASE_PATH + \"/register\",\r\n            method: \"POST\",\r\n            data: {\r\n                username: oModel.getProperty(\"/newUsername\")\r\n            },\r\n            success: oData => {\r\n                this.onCloseCreateDialog();\r\n                this.onRefresh();\r\n            },\r\n            error: this.onError.bind(this)\r\n        });\r\n    },\r\n\r\n    onNavBack() {\r\n        window.history.go(-1);\r\n    }\r\n});\r\n"]}